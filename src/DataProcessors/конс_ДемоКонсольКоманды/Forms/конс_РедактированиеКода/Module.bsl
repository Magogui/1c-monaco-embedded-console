
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	конс_ОбщийМодульСервер.ПриСозданииНаСервере(ЭтотОбъект);
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	конс_ОбщийМодульКлиент.ПриОткрытии(ЭтотОбъект);
	
	ПодключитьОбработчикОжидания("конс_НачальноеЗаполнение", 2, Истина);
	
КонецПроцедуры

&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)
	конс_ОбщийМодульКлиент.ПередЗакрытием(ЭтотОбъект, Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка);
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаКлиенте
Процедура конс_НачальноеЗаполнение() Экспорт
	
	конс_ОбщийМодульКлиент.View(ЭтотОбъект).clearMetadata();
	конс_ОбновитьСписокОбщихМодулей();
	
	// Установим демонстрационный код
	ДемоКод = "Процедура ПримерПроцедуры()
	|	
	|	// Это демонстрационный код для тестирования методов консоли
	|	Сообщить(""Привет, мир!"");
	|	
	|	Для Счетчик = 1 По 10 Цикл
	|		Сообщить(""Строка "" + Счетчик);
	|	КонецЦикла;
	|	
	|КонецПроцедуры
	|
	|Функция ПримерФункции(Параметр1, Параметр2)
	|	
	|	Результат = Параметр1 + Параметр2;
	|	Возврат Результат;
	|	
	|КонецФункции";
	
	конс_ОбщийМодульКлиент.УстановитьТекст(ЭтотОбъект, ДемоКод, Неопределено, Ложь);
	
	Доступность = ЭтотОбъект.конс_ДокументЗагружен;
	
КонецПроцедуры

&НаКлиенте
Процедура конс_ОбновитьСписокОбщихМодулей()
	
	КоллекцияМетаданных = ПолучитьИзВременногоХранилища(ЭтотОбъект.конс_АдресОбщихМодулей);
	
	Если КоллекцияМетаданных <> Неопределено Тогда
		Результат = конс_ОбщийМодульКлиент.View(ЭтотОбъект).updateMetadata(КоллекцияМетаданных, "commonModules.items");
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура конс_ПодключаемыйДокументСформирован(Элемент)
	
	Если ЭтотОбъект.конс_ИсходникиЗагружены Тогда
		конс_ОбщийМодульКлиент.ДокументСформирован(Элемент, ЭтотОбъект);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура конс_ПодключаемыйПриНажатии(Элемент, ДанныеСобытия, СтандартнаяОбработка)
	
	конс_ОбщийМодульКлиент.ОбработатьСобытиеРедактора(ЭтотОбъект, ДанныеСобытия.Event.eventData1C);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Управление отображением
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура ПоказатьНомераСтрок(Команда)
	
	конс_ОбщийМодульКлиент.ПоказатьНомераСтрок(ЭтотОбъект);
	Сообщить("Номера строк показаны");
	
КонецПроцедуры

&НаКлиенте
Процедура СкрытьНомераСтрок(Команда)
	
	конс_ОбщийМодульКлиент.СкрытьНомераСтрок(ЭтотОбъект);
	Сообщить("Номера строк скрыты");
	
КонецПроцедуры

&НаКлиенте
Процедура ВключитьМиникарту(Команда)
	
	конс_ОбщийМодульКлиент.Миникарта(ЭтотОбъект, Истина);
	Сообщить("Миникарта включена");
	
КонецПроцедуры

&НаКлиенте
Процедура ВыключитьМиникарту(Команда)
	
	конс_ОбщийМодульКлиент.Миникарта(ЭтотОбъект, Ложь);
	Сообщить("Миникарта выключена");
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Работа с текстом
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура ПолучитьТекст(Команда)
	
	Текст = конс_ОбщийМодульКлиент.ПолучитьТекст(ЭтотОбъект);
	Сообщить("Длина текста: " + СтрДлина(Текст) + " символов");
	
КонецПроцедуры

&НаКлиенте
Процедура УстановитьТекст(Команда)
	
	НовыйТекст = "// Новый текст установлен через команду
	|Процедура НоваяПроцедура()
	|	Сообщить(""Текст установлен!"");
	|КонецПроцедуры";
	
	конс_ОбщийМодульКлиент.УстановитьТекст(ЭтотОбъект, НовыйТекст, Неопределено, Истина);
	Сообщить("Текст установлен");
	
КонецПроцедуры

&НаКлиенте
Процедура ОчиститьТекст(Команда)
	
	конс_ОбщийМодульКлиент.ОчиститьТекст(ЭтотОбъект);
	Сообщить("Текст очищен");
	
КонецПроцедуры

&НаКлиенте
Процедура ВставитьСтроку(Команда)
	
	// Вставим комментарий в начало кода
	конс_ОбщийМодульКлиент.ВставитьСтроку(ЭтотОбъект, 1, "// Строка вставлена через команду");
	Сообщить("Строка вставлена в начало");
	
КонецПроцедуры

&НаКлиенте
Процедура ДобавитьСтроку(Команда)
	
	// Добавим комментарий в конец кода
	конс_ОбщийМодульКлиент.ДобавитьСтроку(ЭтотОбъект, "// Строка добавлена в конец через команду");
	Сообщить("Строка добавлена в конец");
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Работа с выделением
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура ПолучитьВыделенныйТекст(Команда)
	
	ВыделенныйТекст = конс_ОбщийМодульКлиент.ПолучитьВыделенныйТекст(ЭтотОбъект);
	
	Если ЗначениеЗаполнено(ВыделенныйТекст) Тогда
		Сообщить("Выделенный текст: " + ВыделенныйТекст);
	Иначе
		Сообщить("Текст не выделен");
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ЗаменитьВыделенныйТекст(Команда)
	
	ВыделенныйТекст = конс_ОбщийМодульКлиент.ПолучитьВыделенныйТекст(ЭтотОбъект);
	
	Если ЗначениеЗаполнено(ВыделенныйТекст) Тогда
		// Преобразуем в верхний регистр
		НовыйТекст = ВРег(ВыделенныйТекст);
		конс_ОбщийМодульКлиент.ЗаменитьВыделенныйТекст(ЭтотОбъект, НовыйТекст);
		Сообщить("Выделенный текст заменен на верхний регистр");
	Иначе
		Сообщить("Сначала выделите текст");
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура УстановитьВыделение(Команда)
	
	// Выделим строки с 2 по 5
	конс_ОбщийМодульКлиент.УстановитьВыделение(ЭтотОбъект, 2, 1, 5, 100);
	Сообщить("Установлено выделение со строки 2 по 5");
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Координаты и позиция
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура ПолучитьКоординатыВыделения(Команда)
	
	Координаты = конс_ОбщийМодульКлиент.ПолучитьКоординатыВыделения(ЭтотОбъект);
	
	Сообщение = СтрШаблон("Координаты выделения:
	|Начало: строка %1, колонка %2
	|Конец: строка %3, колонка %4",
		Строка(Координаты.startLineNumber),
		Строка(Координаты.startColumn),
		Строка(Координаты.endLineNumber),
		Строка(Координаты.endColumn));
	
	Сообщить(Сообщение);
	
КонецПроцедуры

&НаКлиенте
Процедура ПолучитьНомераСтрокВыделения(Команда)
	
	Строки = конс_ОбщийМодульКлиент.ПолучитьНомераСтрокВыделения(ЭтотОбъект);
	
	Сообщение = СтрШаблон("Номера строк выделения:
	|Начальная строка: %1
	|Конечная строка: %2
	|Всего строк: %3",
		Строка(Строки.startLine),
		Строка(Строки.endLine),
		Строка(Строки.totalLines));
	
	Сообщить(Сообщение);
	
КонецПроцедуры

&НаКлиенте
Процедура ПоказатьКоординатыВыделения(Команда)
	
	конс_ОбщийМодульКлиент.ПоказатьКоординатыВыделения(ЭтотОбъект);
	Сообщить("Панель координат выделения показана");
	
КонецПроцедуры

&НаКлиенте
Процедура ПолучитьТекущуюСтроку(Команда)
	
	НомерСтроки = конс_ОбщийМодульКлиент.ПолучитьТекущуюСтроку(ЭтотОбъект);
	Сообщить("Текущая строка: " + НомерСтроки);
	
КонецПроцедуры

&НаКлиенте
Процедура ПолучитьТекущуюКолонку(Команда)
	
	НомерКолонки = конс_ОбщийМодульКлиент.ПолучитьТекущуюКолонку(ЭтотОбъект);
	Сообщить("Текущая колонка: " + НомерКолонки);
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Навигация и поиск
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура НайтиТекст(Команда)
	
	// Найдем слово "Процедура"
	конс_ОбщийМодульКлиент.НайтиТекст(ЭтотОбъект, "Процедура");
	Сообщить("Выполнен поиск слова 'Процедура'");
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьВиджетПоиска(Команда)
	
	конс_ОбщийМодульКлиент.ОткрытьВиджетПоиска(ЭтотОбъект);
	
КонецПроцедуры

&НаКлиенте
Процедура ПерейтиКСтроке(Команда)
	
	конс_ОбщийМодульКлиент.ПерейтиКСтроке(ЭтотОбъект);
	
КонецПроцедуры

&НаКлиенте
Процедура ПоказатьСтрокуВЦентре(Команда)
	
	// Покажем строку 5 в центре экрана
	конс_ОбщийМодульКлиент.ПоказатьСтрокуВЦентре(ЭтотОбъект, 5);
	Сообщить("Строка 5 показана в центре");
	
КонецПроцедуры

&НаКлиенте
Процедура ПерейтиКПарнойСкобке(Команда)
	
	конс_ОбщийМодульКлиент.ПерейтиКПарнойСкобке(ЭтотОбъект);
	Сообщить("Выполнен переход к парной скобке");
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Закладки
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура ДобавитьЗакладку(Команда)
	
	ТекущаяСтрока = конс_ОбщийМодульКлиент.ПолучитьТекущуюСтроку(ЭтотОбъект);
	
	Если конс_ОбщийМодульКлиент.ДобавитьЗакладку(ЭтотОбъект, ТекущаяСтрока) Тогда
		Сообщить("Закладка добавлена на строку " + ТекущаяСтрока);
	Иначе
		Сообщить("Закладка уже существует на строке " + ТекущаяСтрока);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура УдалитьЗакладку(Команда)
	
	ТекущаяСтрока = конс_ОбщийМодульКлиент.ПолучитьТекущуюСтроку(ЭтотОбъект);
	
	Если конс_ОбщийМодульКлиент.УдалитьЗакладку(ЭтотОбъект, ТекущаяСтрока) Тогда
		Сообщить("Закладка удалена со строки " + ТекущаяСтрока);
	Иначе
		Сообщить("На строке " + ТекущаяСтрока + " нет закладки");
	КонецЕсли;
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Темы оформления
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура УстановитьТемуСветлую(Команда)
	
	конс_ОбщийМодульКлиент.УстановитьТему(ЭтотОбъект, "bsl-white");
	Сообщить("Установлена светлая тема");
	
КонецПроцедуры

&НаКлиенте
Процедура УстановитьТемуТемную(Команда)
	
	конс_ОбщийМодульКлиент.УстановитьТему(ЭтотОбъект, "bsl-dark");
	Сообщить("Установлена темная тема");
	
КонецПроцедуры

&НаКлиенте
Процедура РежимТолькоДляЧтенияВкл(Команда)
	
	конс_ОбщийМодульКлиент.УстановитьРежимТолькоДляЧтения(ЭтотОбъект, Истина);
	Сообщить("Режим только для чтения включен");
	
КонецПроцедуры

&НаКлиенте
Процедура РежимТолькоДляЧтенияВыкл(Команда)
	
	конс_ОбщийМодульКлиент.УстановитьРежимТолькоДляЧтения(ЭтотОбъект, Ложь);
	Сообщить("Режим только для чтения выключен");
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Маркеры и ошибки
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура УстановитьМаркеры(Команда)
	
	// Создадим пример маркеров
	МассивМаркеров = Новый Массив;
	
	// Добавим ошибку на строку 3
	Ошибка = Новый Структура;
	Ошибка.Вставить("lineNumber", 3);
	Ошибка.Вставить("startColumn", 1);
	Ошибка.Вставить("endColumn", 50);
	Ошибка.Вставить("severity", "Error");
	Ошибка.Вставить("message", "Пример ошибки");
	Ошибка.Вставить("code", "E001");
	Ошибка.Вставить("source", "Демо");
	МассивМаркеров.Добавить(Ошибка);
	
	// Добавим предупреждение на строку 5
	Предупреждение = Новый Структура;
	Предупреждение.Вставить("lineNumber", 5);
	Предупреждение.Вставить("startColumn", 1);
	Предупреждение.Вставить("endColumn", 30);
	Предупреждение.Вставить("severity", "Warning");
	Предупреждение.Вставить("message", "Пример предупреждения");
	Предупреждение.Вставить("code", "W001");
	Предупреждение.Вставить("source", "Демо");
	МассивМаркеров.Добавить(Предупреждение);
	
	// Добавим информацию на строку 7
	Информация = Новый Структура;
	Информация.Вставить("lineNumber", 7);
	Информация.Вставить("startColumn", 1);
	Информация.Вставить("endColumn", 20);
	Информация.Вставить("severity", "Info");
	Информация.Вставить("message", "Пример информации");
	Информация.Вставить("code", "I001");
	Информация.Вставить("source", "Демо");
	МассивМаркеров.Добавить(Информация);
	
	// Преобразуем в JSON
	ЗаписьJSON = Новый ЗаписьJSON;
	ЗаписьJSON.УстановитьСтроку();
	ЗаписатьJSON(ЗаписьJSON, МассивМаркеров);
	МаркерыJSON = ЗаписьJSON.Закрыть();
	
	// Установим маркеры
	конс_ОбщийМодульКлиент.УстановитьМаркеры(ЭтотОбъект, МаркерыJSON);
	Сообщить("Установлены примеры маркеров: ошибка (строка 3), предупреждение (строка 5), информация (строка 7)");
	
КонецПроцедуры

// ═══════════════════════════════════════════════════════════════════════════
// ГРУППА: Дополнительные методы
// ═══════════════════════════════════════════════════════════════════════════

&НаКлиенте
Процедура ОтформатироватьТекст(Команда)
	
	конс_ОбщийМодульКлиент.ОтформатироватьТекст(ЭтотОбъект);
	Сообщить("Текст отформатирован");
	
КонецПроцедуры

&НаКлиенте
Процедура ПоказатьСправку(Команда)
	
	конс_ОбщийМодульКлиент.ПоказатьСправку(ЭтотОбъект);
	Сообщить("Справка показана");
	
КонецПроцедуры

&НаКлиенте
Процедура СкрытьСправку(Команда)
	
	конс_ОбщийМодульКлиент.СкрытьСправку(ЭтотОбъект);
	Сообщить("Справка скрыта");
	
КонецПроцедуры

&НаКлиенте
Процедура СброситьПозициюКнопкиПомощи(Команда)
	
	конс_ОбщийМодульКлиент.СброситьПозициюКнопкиПомощи(ЭтотОбъект);
	Сообщить("Позиция кнопки помощи сброшена");
	
КонецПроцедуры

#КонецОбласти
